<!DOCTYPE html>
<html lang="es">

<head>
	<title>Casa Inteligente</title>
	<link rel="shortcut icon" type="image/png" href="/assets/img/favicon.png" />
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="theme-color" content="#000">

	<link rel="stylesheet" href="/assets/css/style.css">

	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,400italic">
	<link rel="stylesheet" href="/assets/lib/angular-material/angular-material.min.css">
	<link rel="stylesheet" href="/assets/lib/font-awsome/web-fonts-with-css/css/fontawesome-all.min.css">

	<script src="/assets/lib/moment/min/moment-with-locales.min.js"></script>
</head>

<body ng-app="app" layout="column" ng-controller="DeviceController">
	<md-toolbar layout="row">
		<md-button class="menu" ng-click="toggleMenu();" aria-label="show device list" hide-gt-sm>
			<md-icon class="fas fa-bars">
		</md-button>
		<h3 flex>Casa Inteligente</h3>
	</md-toolbar>
	<div class="container" layout="row" flex>
		<md-sidenav md-is-locked-open="$mdMedia('gt-sm')" class="md-whiteframe-4dp" md-component-id="left">
			<md-list ng-click="toggleMenu();">
				<md-list-item ng-repeat="device in devices">
					<md-button ng-click="select(device)" ng-class="device.status">
						<md-icon class="status avatar">
							<i class="fas fa-dot-circle fa-3x"></i>
						</md-icon>
						{{device.name}}
					</md-button>
				</md-list-item>
			</md-list>
			<md-button class="md-fab md-primary" aria-label="new device" ng-click="openAddDevice($event)">
				<i class="fas fa-plus"></i>
			</md-button>
		</md-sidenav>
		<md-content id="content" flex>
			<device device="current"></device>
		</md-content>
	</div>

	<div style="visibility: hidden">
		<div class="md-dialog-container" id="newDevicePopup">
			<md-dialog layout-padding>
				<h2>Agregar nuevo dispositivo</h2>
				<p ng-show="!newDevice.connected">
					Revise sus conexiones WiFi y conectest√© a una cuyo nombre sea ESP-#### donde ### es el ID del dispositivo
				</p>
				<form name="newDeviceForm" ng-show="newDevice.connected">
					<div layout="row">
						<md-input-container flex>
							<label>WiFi</label>
							<input ng-model="newDevice.ssid" required/>
						</md-input-container>
						<md-input-container flex>
							<label>Password</label>
							<input ng-model="newDevice.password" type="password" required/>
						</md-input-container>
					</div>

					<div layout="row">
						<md-input-container flex="50">
							<label>Mqtt Connection String</label>
							<input ng-model="newDevice.mqttConnectionString" required placeholder="mqtt://username:password@host:port" />
						</md-input-container>
						<md-input-container flex>
							<label>Mqtt Topic Base</label>
							<input ng-model="newDevice.mqttTopicBase" required />
						</md-input-container>
						<md-input-container flex>
							<label>Device Name</label>
							<input ng-model="newDevice.deviceName" required/>
						</md-input-container>
					</div>

					<div layout="row">
						<md-input-container flex>
							<label>Host Address</label>
							<input ng-model="newDevice.serverAddress" type="ip" required ng-pattern='/\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/' placeholder='xxx.xxx.xxx.xxx'
							/>
						</md-input-container>
						<md-input-container>
							<label>Host Port</label>
							<input ng-model="newDevice.serverPort" type="number" required />
						</md-input-container>
					</div>

					<div layout="row" layout-align="end">
						<md-button class="md-raised md-primary" ng-click="setNewDevice(newDevice)">Guardar</md-button>
					</div>
				</form>
				<div ng-show="newDevice.message">
					{{newDevice.message}}
				</div>
			</md-dialog>
		</div>
	</div>

	<!-- AngularJs -->
	<script src="/assets/lib/angular/angular.min.js"></script>
	<script src="/assets/lib/angular-animate/angular-animate.min.js"></script>
	<script src="/assets/lib/angular-aria/angular-aria.min.js"></script>
	<script src="/assets/lib/angular-material/angular-material.min.js"></script>
	<script src="/assets/lib/angular-resource/angular-resource.min.js"></script>

	<script src="/assets/lib/chart.js/dist/Chart.min.js"></script>
	<script src="https://cdn.rawgit.com/jtblin/angular-chart.js/1.0.3/angular-chart.js" type="text/javascript"> </script>

	<script src="app/app.module.js"></script>
	<script src="/app/socket.factory.js"></script>
	<script src="app/components/device.service.js"></script>

	<script src="/app/DeviceController.js"></script>
	<script src="/app/components/device/device.component.js"></script>
	<script src="app/components/component/component.component.js"></script>
	<script src="app/components/metric/metric.component.js"></script>
	<script src="app/components/logs/logs.component.js"></script>

	<script src="/socket.io/socket.io.js"></script>
</body>

</html>